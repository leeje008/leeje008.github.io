<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="밑바닥부터 시작하는 딥러닝 Chapter07" /><meta property="og:locale" content="ko" /><meta name="description" content="Chapter 7 합성곱 신경망(CNN)" /><meta property="og:description" content="Chapter 7 합성곱 신경망(CNN)" /><link rel="canonical" href="https://leeje008.github.io/posts/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0-%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94-%EB%94%A5%EB%9F%AC%EB%8B%9D-Chapter07/" /><meta property="og:url" content="https://leeje008.github.io/posts/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0-%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94-%EB%94%A5%EB%9F%AC%EB%8B%9D-Chapter07/" /><meta property="og:site_name" content="Yh’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-02T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="밑바닥부터 시작하는 딥러닝 Chapter07" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-05T17:02:11+09:00","datePublished":"2022-01-02T00:00:00+09:00","description":"Chapter 7 합성곱 신경망(CNN)","headline":"밑바닥부터 시작하는 딥러닝 Chapter07","mainEntityOfPage":{"@type":"WebPage","@id":"https://leeje008.github.io/posts/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0-%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94-%EB%94%A5%EB%9F%AC%EB%8B%9D-Chapter07/"},"url":"https://leeje008.github.io/posts/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0-%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94-%EB%94%A5%EB%9F%AC%EB%8B%9D-Chapter07/"}</script><title>밑바닥부터 시작하는 딥러닝 Chapter07 | Yh's blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Yh's blog"><meta name="application-name" content="Yh's blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/me3.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Yh's blog</a></div><div class="site-subtitle font-italic">Final success will be made repeated attempts</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/leeje008" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['leeje008','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.facebook.com/profile.php?id=100006983951106" aria-label="facebook" > <i class="fab fa-facebook"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>밑바닥부터 시작하는 딥러닝 Chapter07</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>밑바닥부터 시작하는 딥러닝 Chapter07</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1641049200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 2, 2022 </em> </span> <span> Updated <em class="" data-ts="1662364931" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 5, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/leeje008">Koyounghun</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4033 words"> <em>22 min</em> read</span></div></div></div><div class="post-content"><h1 id="chapter-7-합성곱-신경망cnn">Chapter 7 합성곱 신경망(CNN)</h1><h2 id="71-전체-구조"><span class="mr-2">7.1 전체 구조</span><a href="#71-전체-구조" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>CNN에서 등장하는 새로운 layer</p><ul><li>합성곱 계층(convolutional layer)<li>풀링 계층(pooling layer)</ul><p>현재까지 봤던 신경망을 완전연결(fully-connected)라고 하며 Affine 계층으로 구현했다. Affine 계층 뒤에는 활성화 함수로 ReLU 혹은 Sigmoid를 사용했다.</p><p>CNN의 구조는 새로운 합성곱 계층(Conv)과 풀링 계층(pooling)이 추가된다. Conv-ReLU-(Pooling)의 흐름이다. 출력층과 가까운 층의 경우에는 Affine-ReLU, 출력층은 Affine-Softmax 조합을 그대로 사용한다.</p><p><img data-src="https://t1.daumcdn.net/cfile/tistory/2409463658F46CAD1F" data-proofer-ignore></p><center><small>▲ 완전연결 계층(위), CNN(아래)</small></center><h2 id="72-합성곱-계층"><span class="mr-2">7.2 합성곱 계층</span><a href="#72-합성곱-계층" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>패딩(padding)<li>스트라이드(stride)<li>입체적인 데이터 흐름</ul><h3 id="721-완전연결-계층의-문제점"><span class="mr-2">7.2.1 완전연결 계층의 문제점</span><a href="#721-완전연결-계층의-문제점" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>데이터의 형상이 무시된다.</p><ul><li>완전연결 계층의 입력은 평탄화 필요<li>본래 다차원인 데이터의 경우 다차원에서 특별한 정보가 담겨있을 가능성이 있다.<li>이미지의 경우<ul><li>가로, 세로, 색상의 3차원 데이터<li>공간적 정보</ul></ul><p>반면, 합성곱 계층은 형상을 유지한다.</p><ul><li>입력 데이터가 형상 그대로 들어온다.<li>다음 계층으로 전달될 때도 그대로 전달<li>다차원의 형상을 가진 데이터를 올바르게 이해할 수 있다.<li>특징 맵(feature map): 합성곱 계층의 입출력 데이터<ul><li>입력 특징 맵(input feature map)<li>출력 특징 맵(output feature map)</ul></ul><h3 id="722-합성곱-연산"><span class="mr-2">7.2.2 합성곱 연산</span><a href="#722-합성곱-연산" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>합성곱 연산 = 필터 연산</p><p>합성곱 연산 예제 <img data-src="https://t1.daumcdn.net/cfile/tistory/2764173558F475B42C" data-proofer-ignore></p><p>데이터 설명</p><ul><li>입력 데이터: (4,4)의 높이와 너비를 가진 형상<li>필터: (3,3)의 높이와 너비를 가진 형상<ul><li>커널이라고도 한다.</ul><li>출력: (2,2)의 놆이와 너비를 가진 형상</ul><p>연산 과정</p><ol><li>필터의 <strong>윈도우(window)</strong>를 일정 간격으로 이동하면서 입력 데이터에 적용<li>단일 곱셈-누산(fused multiply-add, FMA): 대응하는 원소기리 곱한 후 모두 더함<li>결과를 출력의 해당 장소에 저장<li>모든 장소에서 수행</ol><p>가중치와 편향</p><ul><li>가중치: 필터의 매개변수<li>편향: 필터를 적용한 후 데이터에 더해진다. 항상 하나(1X1)만 존재</ul><h3 id="723-패딩"><span class="mr-2">7.2.3 패딩</span><a href="#723-패딩" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>패딩(padding)</p><ul><li>입력 데이터 주변을 특정 값으로 채우는 것<li>예를 들어 0으로</ul><p>패딩의 예</p><p><img data-src="https://t1.daumcdn.net/cfile/tistory/2527FA3758F4785B13" data-proofer-ignore></p><ul><li>입력데이터: 4X4<li>패딩 후: 6X6<li>3X3 필터 적용 후: 4X4</ul><p>패딩을 하는 이유</p><ul><li>출력 크기를 조정하는 목적<li>합성곱 신경망에서 그냥 필터를 적용하면 계속해서 크기가 줄어든다. 신경망이 깊어지면 어느 순간 크기가 1이 되어버린다. 이는 더이상 합성곱을 할 수 없는 상태이기 때문에 문제가 된다.<li>풀링을 하면 출력 크기를 유지시켜 줄 수 있어서, 입력 데이터의 공간적 크기를 고정해서 다음 층으로 넘겨줄 수 있다.</ul><h3 id="724-스트라이드"><span class="mr-2">7.2.4 스트라이드</span><a href="#724-스트라이드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>스트라이드</p><ul><li>필터를 적용하는 위치 간격<li>스트라이드를 키우면 출력 크기가 작아진다.</ul><p><img data-src="https://2.bp.blogspot.com/-vtZW1-cBQGg/WYJrUnBjRiI/AAAAAAAALNY/GhTnu5QDi3M4NHB_FiyOJAjy58mTkzlYwCK4BGAYYCw/s320/o9.PNG" data-proofer-ignore></p><center><small>▲ 스트라이드가 2인 합성곱 신경망</small></center><p>패딩, 스트라이드, 출력 크기 계산</p><ul><li>입력 크기: $(H, W)$<li>필터 크기: $(FH, FW)$<li>출력 크기: $(OH, OW)$<li>패딩: $P$<li>스트라이드: $S$</ul>\[OH = \frac {H + 2P - FH} S + 1\] \[OW = \frac {W + 2P - FW} S + 1\]<p>주의</p><ul><li>계산 결과가 정수로 나누어 떨어져야 한다.</ul><h3 id="725-3차원-데이터의-합성곱-연산"><span class="mr-2">7.2.5 3차원 데이터의 합성곱 연산</span><a href="#725-3차원-데이터의-합성곱-연산" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>3차원 데이터의 합성곱 연산 예</p><p><img data-src="https://t1.daumcdn.net/cfile/tistory/99C185405BC97F4D1E" data-proofer-ignore></p><ul><li>입력 데이터의 채널 수 = 필터의 채널 수<li>필터의 크기는 원하는 크기로(모든 채널의 필터 크기는 같아야 함)</ul><h3 id="726-블록으로-생각하기"><span class="mr-2">7.2.6 블록으로 생각하기</span><a href="#726-블록으로-생각하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="https://t1.daumcdn.net/cfile/tistory/998CE7355BC97F632E" data-proofer-ignore></p><ul><li>데이터와 필터의 형상: (채널, 높이, 너비)<li>출력: 채널이 1개인 특징 맵</ul><p><img data-src="https://t1.daumcdn.net/cfile/tistory/99CDF2395BC97F7C2D" data-proofer-ignore></p><ul><li>필터를 여러 개 사용하면 출력의 채널 수도 늘어남<li>이 출력을 다음 층으로 넘겨준다.<li>필터의 가중치 데이터는 4차원: (출력 채널 수, 입력 채널 수, 높이, 너비)<li>편향: 채널당 하나의 값</ul><h3 id="727-배치-처리"><span class="mr-2">7.2.7 배치 처리</span><a href="#727-배치-처리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="https://t1.daumcdn.net/cfile/tistory/99E4C84E5C4D31B728" data-proofer-ignore></p><ul><li>4차원으로 데이터 저장: (데이터 수, 채널 수, 높이, 너비)<li>가장 앞쪽에 배치용 차원을 추가<li>각 흐름마다 N번의 합성곱 연산을 수행<li>배치 처리의 효과는 완전연결 신경망과 동일</ul><h2 id="73-풀링-계층"><span class="mr-2">7.3 풀링 계층</span><a href="#73-풀링-계층" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>풀링 계층</p><ul><li>가로, 세로 방향의 공간을 줄이는 연산</ul><p>풀링의 예</p><p><img data-src="https://t1.daumcdn.net/cfile/tistory/993A5B465C4D32D32C" data-proofer-ignore></p><ul><li>최대 풀링(max pooling)<ul><li>대상 영역 내에서 최대값을 구하는 연산</ul><li>평균 풀링(average pooling)<ul><li>대상 영역의 평균을 계산</ul><li>이미지 인식 분야에서는 최대 풀링을 사용<li>윈도우 크기와 스트라이드는 동일한 값으로 하는 것이 일반적<ul><li>위의 예: 윈도우 2X2, 스트라이드 2</ul></ul><h3 id="731-풀링-계층의-특징"><span class="mr-2">7.3.1 풀링 계층의 특징</span><a href="#731-풀링-계층의-특징" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>학습해야 할 매개변수가 없다.</p><p>채널 수가 변하지 않는다.</p><ul><li>채널마다 독립적으로 계산하기 때문</ul><p>입력의 변화에 영향을 적게 받는다(강건하다).</p><ul><li>입력 데이터가 조금 변해도 풀링 결과는 잘 변하지 않는다.</ul><h2 id="74-합성곱풀링-계층-구현하기"><span class="mr-2">7.4 합성곱/풀링 계층 구현하기</span><a href="#74-합성곱풀링-계층-구현하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="741-4차원-배열"><span class="mr-2">7.4.1 4차원 배열</span><a href="#741-4차원-배열" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>CNN에서 흐르는 데이터는 4차원이다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
<span class="n">x</span><span class="p">.</span><span class="n">shape</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(10, 1, 28, 28)
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 첫번째 데이터에 접근
</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">shape</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(1, 28, 28)
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 두번째 데이터에 접근
</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">shape</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(1, 28, 28)
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 첫번째 데이터의 첫 채널에 접근
</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>array([[9.44322204e-01, 1.61725959e-01, 4.97299575e-01, 4.90849763e-01,
        2.69806956e-01, 4.80739959e-01, 5.33766630e-01, 3.52483845e-01,
        5.90821168e-01, 5.07826272e-01, 6.40826973e-01, 4.59954326e-01,
        5.82373841e-01, 6.52799925e-02, 3.35695899e-01, 4.61650460e-01,
        8.95937799e-01, 6.28431996e-02, 6.36711673e-01, 5.50039978e-01,
        8.44648519e-01, 4.38516371e-01, 5.49044826e-01, 8.53925508e-01,
        1.25532691e-01, 9.38128354e-01, 3.10436399e-01, 6.31229430e-02],
       .......
       ,
       [1.09660007e-01, 3.29975706e-01, 6.27062235e-01, 2.80376880e-02,
        3.70181133e-01, 2.82339621e-01, 2.81632554e-01, 1.34358950e-01,
        5.66760294e-01, 2.94240600e-01, 5.15104998e-01, 1.93230444e-02,
        5.47469657e-01, 2.10305031e-01, 3.66689889e-02, 5.87465571e-01,
        3.07306557e-01, 8.89560760e-01, 5.15682357e-01, 8.76126342e-01,
        7.75768722e-01, 9.25446546e-01, 3.85371285e-01, 7.81498205e-01,
        1.90269789e-01, 9.38474719e-01, 1.95191469e-01, 8.50734947e-01]])
</pre></table></code></div></div><h3 id="742-im2col로-데이터-전개하기"><span class="mr-2">7.4.2 im2col로 데이터 전개하기</span><a href="#742-im2col로-데이터-전개하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>넘파이에서 원소를 접근할 때 for 문을 사용하지 않는 것이 바람직하다.</p><p>im2col 함수</p><p><img data-src="https://t1.daumcdn.net/cfile/tistory/99F49B495BA49CE71C" data-proofer-ignore></p><ul><li>입력 데이터를 필터링(가중치 계산)하기 좋게 펼치는 함수<li>입력 데이터에서 필터를 적용하는 영역을 한 줄로 늘어 놓는다.<li>필터를 적용하는 영역이 겹쳐서 메모리를 더 많이 사용하지만, 선형 대수 라이브러리가 행렬 계산을 매우 빠르게 처리해줘서 속도에서는 이점이 있다.<li>Affine 계층에서 한 것과 유사한 계산<li>마지막에 2차원 출력 데이터를 4차원으로 변형(reshape)</ul><h3 id="743-합성곱-계층-구현하기"><span class="mr-2">7.4.3 합성곱 계층 구현하기</span><a href="#743-합성곱-계층-구현하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="c1"># 필터 크기, 스트라이드, 패딩을 고려해서 입력 데이터를 2차원 배열로 전개
</span><span class="k">def</span> <span class="nf">im2col</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">filter_h</span><span class="p">,</span> <span class="n">filter_w</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="s">"""다수의 이미지를 입력받아 2차원 배열로 변환한다(평탄화).
    
    Parameters
    ----------
    input_data : 4차원 배열 형태의 입력 데이터(이미지 수, 채널 수, 높이, 너비)
    filter_h : 필터의 높이
    filter_w : 필터의 너비
    stride : 스트라이드
    pad : 패딩
    
    Returns
    -------
    col : 2차원 배열
    """</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">.</span><span class="n">shape</span>
    <span class="n">out_h</span> <span class="o">=</span> <span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">pad</span> <span class="o">-</span> <span class="n">filter_h</span><span class="p">)</span><span class="o">//</span><span class="n">stride</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">out_w</span> <span class="o">=</span> <span class="p">(</span><span class="n">W</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">pad</span> <span class="o">-</span> <span class="n">filter_w</span><span class="p">)</span><span class="o">//</span><span class="n">stride</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c1"># np.pad(array, pad_width, mode, **kwargs)
</span>    <span class="c1"># array: 패딩할 배열
</span>    <span class="c1"># pad_width: 각 축마다 패딩할 값의 수
</span>    <span class="c1"># mode: 패딩 방식
</span>    <span class="c1"># default로 0으로 패딩
</span>    <span class="c1"># 신경망에서 패딩을 하게 되면 이미지와 채널 수에 해당되는 차원은 하지 않기 때문에 pad_width에 해당되는
</span>    <span class="c1"># 인수의 처음과 두번째 원소가 (0,0)인 것이다. 즉, 해당 차원은 패딩하지 않는다.
</span>    <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">pad</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">pad</span><span class="p">,</span> <span class="n">pad</span><span class="p">),</span> <span class="p">(</span><span class="n">pad</span><span class="p">,</span> <span class="n">pad</span><span class="p">)],</span> <span class="s">'constant'</span><span class="p">)</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">filter_h</span><span class="p">,</span> <span class="n">filter_w</span><span class="p">,</span> <span class="n">out_h</span><span class="p">,</span> <span class="n">out_w</span><span class="p">))</span>

    <span class="c1"># Q. for 문 이해 안됨
</span>    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">filter_h</span><span class="p">):</span>
        <span class="n">y_max</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">stride</span><span class="o">*</span><span class="n">out_h</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">filter_w</span><span class="p">):</span>
            <span class="n">x_max</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">stride</span><span class="o">*</span><span class="n">out_w</span>
            <span class="n">col</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">:</span><span class="n">y_max</span><span class="p">:</span><span class="n">stride</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="n">x_max</span><span class="p">:</span><span class="n">stride</span><span class="p">]</span>

    <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="p">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">out_h</span><span class="o">*</span><span class="n">out_w</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">col</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">sys</span><span class="p">,</span> <span class="n">os</span>
<span class="n">sys</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">pardir</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">common.util</span> <span class="kn">import</span> <span class="n">im2col</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">col1</span> <span class="o">=</span> <span class="n">im2col</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">col1</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(9, 75)
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">col2</span> <span class="o">=</span> <span class="n">im2col</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">col2</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(90, 75)
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Convolution</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">W</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">stride</span> <span class="o">=</span> <span class="n">stride</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pad</span> <span class="o">=</span> <span class="n">pad</span>
        
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">FN</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">FH</span><span class="p">,</span> <span class="n">FW</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">W</span><span class="p">.</span><span class="n">shape</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">shape</span>
        <span class="n">out_h</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="p">.</span><span class="n">pad</span> <span class="o">-</span> <span class="n">FH</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">stride</span><span class="p">)</span>
        <span class="n">out_w</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">W</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="p">.</span><span class="n">pad</span> <span class="o">-</span> <span class="n">FW</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">stride</span><span class="p">)</span>
        
        <span class="n">col</span> <span class="o">=</span> <span class="n">im2col</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">FH</span><span class="p">,</span> <span class="n">FW</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">stride</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">col_W</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">W</span><span class="p">.</span><span class="n">shape</span><span class="p">(</span><span class="n">FN</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">).</span> <span class="n">T</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">col_W</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">b</span>
        
        <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">out_h</span><span class="p">,</span> <span class="n">out_w</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">out</span>
</pre></table></code></div></div><p>역전파에서는 im2col을 반대로 처리하는 col2im을 사용한다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">col2im</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">,</span> <span class="n">filter_h</span><span class="p">,</span> <span class="n">filter_w</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="s">"""(im2col과 반대) 2차원 배열을 입력받아 다수의 이미지 묶음으로 변환한다.
    
    Parameters
    ----------
    col : 2차원 배열(입력 데이터)
    input_shape : 원래 이미지 데이터의 형상（예：(10, 1, 28, 28)）
    filter_h : 필터의 높이
    filter_w : 필터의 너비
    stride : 스트라이드
    pad : 패딩
    
    Returns
    -------
    img : 변환된 이미지들
    """</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="n">input_shape</span>
    <span class="n">out_h</span> <span class="o">=</span> <span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">pad</span> <span class="o">-</span> <span class="n">filter_h</span><span class="p">)</span><span class="o">//</span><span class="n">stride</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">out_w</span> <span class="o">=</span> <span class="p">(</span><span class="n">W</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">pad</span> <span class="o">-</span> <span class="n">filter_w</span><span class="p">)</span><span class="o">//</span><span class="n">stride</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">out_h</span><span class="p">,</span> <span class="n">out_w</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">filter_h</span><span class="p">,</span> <span class="n">filter_w</span><span class="p">).</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">pad</span> <span class="o">+</span> <span class="n">stride</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">W</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">pad</span> <span class="o">+</span> <span class="n">stride</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">filter_h</span><span class="p">):</span>
        <span class="n">y_max</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">stride</span><span class="o">*</span><span class="n">out_h</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">filter_w</span><span class="p">):</span>
            <span class="n">x_max</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">stride</span><span class="o">*</span><span class="n">out_w</span>
            <span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">:</span><span class="n">y_max</span><span class="p">:</span><span class="n">stride</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="n">x_max</span><span class="p">:</span><span class="n">stride</span><span class="p">]</span> <span class="o">+=</span> <span class="n">col</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>

    <span class="k">return</span> <span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">pad</span><span class="p">:</span><span class="n">H</span> <span class="o">+</span> <span class="n">pad</span><span class="p">,</span> <span class="n">pad</span><span class="p">:</span><span class="n">W</span> <span class="o">+</span> <span class="n">pad</span><span class="p">]</span>
</pre></table></code></div></div><h3 id="744-풀링-계층-구현하기"><span class="mr-2">7.4.4 풀링 계층 구현하기</span><a href="#744-풀링-계층-구현하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="https://t1.daumcdn.net/cfile/tistory/992F044B5C4D422B02" data-proofer-ignore> <img data-src="https://t1.daumcdn.net/cfile/tistory/99C888485C4D425402" data-proofer-ignore></p><p>합성곱 계층과 마찬가지로 im2col 함수를 이용한다. 다만, 다른 점은 채널마다 독립적으로 전개한다는 점이다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Pooling</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pool_h</span><span class="p">,</span> <span class="n">pool_w</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pool_h</span> <span class="o">=</span> <span class="n">pool_h</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pool_w</span> <span class="o">=</span> <span class="n">pool_w</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">stride</span> <span class="o">=</span> <span class="n">stride</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pad</span> <span class="o">=</span> <span class="n">pad</span>
        
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">N</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">shape</span>
        <span class="n">out_h</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">H</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">pool_h</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">stride</span><span class="p">)</span>
        <span class="n">out_w</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">W</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">pool_w</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">stride</span><span class="p">)</span>
        
        <span class="c1"># 전개 (1)
</span>        <span class="n">col</span> <span class="o">=</span> <span class="n">im2col</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">pool_h</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">pool_w</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">stride</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">pad</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">pool_h</span><span class="o">*</span><span class="bp">self</span><span class="p">.</span><span class="n">pool_w</span><span class="p">)</span>
        
        <span class="c1"># 최댓값 (2)
</span>        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># 성형 (3)
</span>        <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">out_h</span><span class="p">,</span> <span class="n">out_w</span><span class="p">,</span> <span class="n">C</span><span class="p">).</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">out</span>
</pre></table></code></div></div><h2 id="75-cnn-구현하기"><span class="mr-2">7.5 CNN 구현하기</span><a href="#75-cnn-구현하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>손글씨 숫자 인식하는 CNN 구현</p><ul><li>구조: conv-relu-pooling-affine-relu-affine-softmax</ul><p>SimpleConvNet 클래스</p><ul><li>__init__<ul><li>인수<ul><li>input_dim: 입력 데이터(채널 수, 높이, 너비)의 차원<li>conv_param: 합성곱 계층의 하이퍼파라미터(딕셔너리)<ul><li>filter_num: 필터 수<li>filter_size: 필터 크기<li>stride: 스트라이드<li>pad: 패딩<li>hidden_size: 은닉층의 뉴런 수<li>output_size: 출력층의 뉴런 수<li>weight_init_std: 초기화 때의 가중치 표준편차</ul></ul></ul></ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">SimpleConvNet</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>
                <span class="n">conv_param</span><span class="o">=</span><span class="p">{</span><span class="s">'filter_num'</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span> <span class="s">'filter_size'</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
                           <span class="s">'pad'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'stride'</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
                <span class="n">hidden_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">weight_init_std</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
        <span class="n">filter_num</span> <span class="o">=</span> <span class="n">conv_param</span><span class="p">[</span><span class="s">'filter_num'</span><span class="p">]</span>
        <span class="n">filter_size</span> <span class="o">=</span> <span class="n">conv_param</span><span class="p">[</span><span class="s">'filter_size'</span><span class="p">]</span>
        <span class="n">filter_pad</span> <span class="o">=</span> <span class="n">conv_param</span><span class="p">[</span><span class="s">'pad'</span><span class="p">]</span>
        <span class="n">filter_stride</span> <span class="o">=</span> <span class="n">conv_param</span><span class="p">[</span><span class="s">'stride'</span><span class="p">]</span>
        <span class="n">input_size</span> <span class="o">=</span> <span class="n">input_dim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">conv_output_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">input_size</span> <span class="o">-</span> <span class="n">filter_size</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">filter_pad</span><span class="p">)</span> <span class="o">/</span> <span class="n">filter_stride</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">pool_output_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">filter_num</span> <span class="o">*</span> <span class="p">(</span><span class="n">conv_output_size</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">conv_output_size</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="s">'W1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight_init_std</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="n">filter_num</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">filter_size</span><span class="p">,</span> <span class="n">filter_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="s">'b1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">filter_num</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="s">'W2'</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight_init_std</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="n">pool_output_size</span><span class="p">,</span> <span class="n">hidden_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="s">'b2'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">hidden_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="s">'W3'</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight_init_std</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="n">hidden_size</span><span class="p">,</span> <span class="n">output_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="s">'b3'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_size</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">layers</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">layers</span><span class="p">[</span><span class="s">'Conv1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Convolution</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="s">'W1'</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="s">'b1'</span><span class="p">],</span>
                                          <span class="n">conv_param</span><span class="p">[</span><span class="s">'stride'</span><span class="p">],</span> <span class="n">conv_param</span><span class="p">[</span><span class="s">'pad'</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">layers</span><span class="p">[</span><span class="s">'Relu1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relu</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">layers</span><span class="p">[</span><span class="s">'Pool1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pooling</span><span class="p">(</span><span class="n">pool_h</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pool_w</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">layers</span><span class="p">[</span><span class="s">'Affine1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Affine</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">parmas</span><span class="p">[</span><span class="s">'W2'</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="s">'b2'</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">layers</span><span class="p">[</span><span class="s">'Relu2'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Relu</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">laeyrs</span><span class="p">[</span><span class="s">'Affine2'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Affine</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="s">'W3'</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">parmas</span><span class="p">[</span><span class="s">'b3'</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">last_layer</span> <span class="o">=</span> <span class="n">SoftmaxWithLoss</span><span class="p">()</span>
        
    
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="p">.</span><span class="n">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">x</span>
    
    
    <span class="k">def</span> <span class="nf">loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">last_layer</span><span class="p">.</span><span class="n">forward</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="c1"># 순전파
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">loss</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
        
        <span class="c1"># 역전파
</span>        <span class="n">dout</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">dout</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">last_layer</span><span class="p">.</span><span class="n">backward</span><span class="p">(</span><span class="n">dout</span><span class="p">)</span>
        
        <span class="n">layers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">layers</span><span class="p">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">layers</span><span class="p">:</span>
            <span class="n">dout</span> <span class="o">=</span> <span class="n">layer</span><span class="p">.</span><span class="n">backward</span><span class="p">(</span><span class="n">dout</span><span class="p">)</span>
            
        <span class="c1"># 결과 저장
</span>        <span class="n">grads</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">grads</span><span class="p">[</span><span class="s">'W1'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">layers</span><span class="p">[</span><span class="s">'Conv1'</span><span class="p">].</span><span class="n">dW</span>
        <span class="n">grads</span><span class="p">[</span><span class="s">'b1'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">layers</span><span class="p">[</span><span class="s">'Conv1'</span><span class="p">].</span><span class="n">db</span>
        <span class="n">grads</span><span class="p">[</span><span class="s">'W2'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">layers</span><span class="p">[</span><span class="s">'Affine1'</span><span class="p">].</span><span class="n">dW</span>
        <span class="n">grads</span><span class="p">[</span><span class="s">'b2'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">layers</span><span class="p">[</span><span class="s">'Affine1'</span><span class="p">].</span><span class="n">db</span>
        <span class="n">grads</span><span class="p">[</span><span class="s">'W3'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">layers</span><span class="p">[</span><span class="s">'Affine2'</span><span class="p">].</span><span class="n">dW</span>
        <span class="n">grads</span><span class="p">[</span><span class="s">'b3'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">layers</span><span class="p">[</span><span class="s">'Affine'</span><span class="p">].</span><span class="n">db</span>
        
        <span class="k">return</span> <span class="n">grads</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="c1"># coding: utf-8
</span><span class="kn">import</span> <span class="nn">sys</span><span class="p">,</span> <span class="n">os</span>
<span class="n">sys</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">pardir</span><span class="p">)</span>  <span class="c1"># 부모 디렉터리의 파일을 가져올 수 있도록 설정
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">dataset.mnist</span> <span class="kn">import</span> <span class="n">load_mnist</span>
<span class="kn">from</span> <span class="nn">simple_convnet</span> <span class="kn">import</span> <span class="n">SimpleConvNet</span>
<span class="kn">from</span> <span class="nn">common.trainer</span> <span class="kn">import</span> <span class="n">Trainer</span>

<span class="c1"># 데이터 읽기
</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">t_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">t_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">load_mnist</span><span class="p">(</span><span class="n">flatten</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># 시간이 오래 걸릴 경우 데이터를 줄인다.
#x_train, t_train = x_train[:5000], t_train[:5000]
#x_test, t_test = x_test[:1000], t_test[:1000]
</span>
<span class="n">max_epochs</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">network</span> <span class="o">=</span> <span class="n">SimpleConvNet</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span> 
                        <span class="n">conv_param</span> <span class="o">=</span> <span class="p">{</span><span class="s">'filter_num'</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s">'filter_size'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">'pad'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">'stride'</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                        <span class="n">hidden_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">weight_init_std</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
                        
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">x_train</span><span class="p">,</span> <span class="n">t_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">t_test</span><span class="p">,</span>
                  <span class="n">epochs</span><span class="o">=</span><span class="n">max_epochs</span><span class="p">,</span> <span class="n">mini_batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                  <span class="n">optimizer</span><span class="o">=</span><span class="s">'Adam'</span><span class="p">,</span> <span class="n">optimizer_param</span><span class="o">=</span><span class="p">{</span><span class="s">'lr'</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">},</span>
                  <span class="n">evaluate_sample_num_per_epoch</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">trainer</span><span class="p">.</span><span class="n">train</span><span class="p">()</span>

<span class="c1"># 매개변수 보존
</span><span class="n">network</span><span class="p">.</span><span class="n">save_params</span><span class="p">(</span><span class="s">"params.pkl"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Saved Network Parameters!"</span><span class="p">)</span>

<span class="c1"># 그래프 그리기
</span><span class="n">markers</span> <span class="o">=</span> <span class="p">{</span><span class="s">'train'</span><span class="p">:</span> <span class="s">'o'</span><span class="p">,</span> <span class="s">'test'</span><span class="p">:</span> <span class="s">'s'</span><span class="p">}</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">max_epochs</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">trainer</span><span class="p">.</span><span class="n">train_acc_list</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">'o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'train'</span><span class="p">,</span> <span class="n">markevery</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">trainer</span><span class="p">.</span><span class="n">test_acc_list</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">'s'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'test'</span><span class="p">,</span> <span class="n">markevery</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"epochs"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"accuracy"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">'lower right'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre><td class="rouge-code"><pre>train loss:2.2995260237545354
=== epoch:1, train acc:0.131, test acc:0.118 ===
train loss:2.2975321648494162
train loss:2.294610007994603
train loss:2.287643742679368
train loss:2.277571750143067
train loss:2.273888829395921
train loss:2.25138555721259
train loss:2.231636338533291
.....
train loss:0.0007504085776238781
train loss:0.0006305754900100426
train loss:3.650351210427843e-05
train loss:0.00011660007186879213
train loss:0.0034911552723316595
train loss:2.7817370077523596e-05
train loss:0.00278068868231808
train loss:0.00860630414349712
train loss:0.000212820545808942
train loss:0.0041047099315977015
train loss:0.0023794835160068843
train loss:0.0026915451634738257
train loss:0.00011453829850605189
train loss:0.0023212412777749184
train loss:4.672228737306881e-05
train loss:0.0005770183132382689
train loss:3.998510631355986e-05
train loss:0.0012251012653243113
train loss:0.001225842621761431
train loss:0.00018016703930926606
train loss:0.0011863858625609006
train loss:0.00020601261406510895
train loss:0.020417215290379324
train loss:0.00020197674243562533
train loss:0.006390657381187902
train loss:0.00010603314122986489
train loss:0.00037329694319883177
train loss:0.0036877658448098848
train loss:0.0006094631970039707
train loss:0.00047120910979439585
train loss:0.00019528056770125042
train loss:0.0001959878676012942
train loss:0.0003382110604612978
train loss:0.0015579024218455577
train loss:0.0026843087959261287
train loss:0.013432609885665527
train loss:0.001941956277535325
train loss:0.0001861940532349634
train loss:0.0027816507925776707
train loss:0.001876821975816105
train loss:0.0008053180855204114
train loss:0.0022498999334715497
train loss:0.0004023503025203104
train loss:0.002829371045887539
train loss:0.006198255683125497
train loss:0.0013390517584302966
train loss:0.0016573133599115631
train loss:0.001934521872157699
train loss:0.0010795976011183056
=============== Final Test Accuracy ===============
test acc:0.9863
Saved Network Parameters!
</pre></table></code></div></div><h2 id="76-cnn--시각화하기"><span class="mr-2">7.6 CNN 시각화하기</span><a href="#76-cnn--시각화하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="761-1번째-층의-가중치-시각화하기"><span class="mr-2">7.6.1 1번째 층의 가중치 시각화하기</span><a href="#761-1번째-층의-가중치-시각화하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="c1"># coding: utf-8
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">simple_convnet</span> <span class="kn">import</span> <span class="n">SimpleConvNet</span>

<span class="k">def</span> <span class="nf">filter_show</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="s">"""
    c.f. https://gist.github.com/aidiary/07d530d5e08011832b12#file-draw_weight-py
    """</span>
    <span class="n">FN</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">FH</span><span class="p">,</span> <span class="n">FW</span> <span class="o">=</span> <span class="n">filters</span><span class="p">.</span><span class="n">shape</span>
    <span class="n">ny</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">FN</span> <span class="o">/</span> <span class="n">nx</span><span class="p">))</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">fig</span><span class="p">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">FN</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">filters</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">gray_r</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">'nearest'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">network</span> <span class="o">=</span> <span class="n">SimpleConvNet</span><span class="p">()</span>
<span class="c1"># 무작위(랜덤) 초기화 후의 가중치
</span><span class="n">filter_show</span><span class="p">(</span><span class="n">network</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="s">'W1'</span><span class="p">])</span>

<span class="c1"># 학습된 가중치
</span><span class="n">network</span><span class="p">.</span><span class="n">load_params</span><span class="p">(</span><span class="s">"params.pkl"</span><span class="p">)</span>
<span class="n">filter_show</span><span class="p">(</span><span class="n">network</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="s">'W1'</span><span class="p">])</span>
</pre></table></code></div></div><p><img data-src="/assets/images/2022-01-02-Chapter7/다운로드.png" alt="다운로드" data-proofer-ignore></p><p>무엇을 보고 있는 것일까?</p><ul><li>에지(색상이 바뀐 경계선), 블롭(국소적으로 덩어리진 영역) 등<li>예: 세로 에지(필터1)과 가로 에지(필터2)에 반응하는 필터 <img data-src="https://t1.daumcdn.net/cfile/tistory/999F114D5C4D500610" data-proofer-ignore><li>초기 계층에서 필터는 원시적인 정보를 추출한다.</ul><h3 id="762-층-깊이에-따른-추출-정보-변화"><span class="mr-2">7.6.2 층 깊이에 따른 추출 정보 변화</span><a href="#762-층-깊이에-따른-추출-정보-변화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>계층이 깊어질수록 추출되는 정보(강하게 반응하는 뉴런)는 더 추상화된다.<li>예: AlexNet<ul><li>일반 사물 인식 8층 CNN<li>마지막 층은 완전연결 계층<li>1층: 에지와 블롭, 3층 텍스쳐, 5층: 사물의 일부, 마지막층: 사물의 클래스에 주로 반응<li>깊어질 수록 사물의 의미를 이해하도록 변화 <img data-src="https://t1.daumcdn.net/cfile/tistory/99AF37505C4D514115" data-proofer-ignore></ul></ul><h2 id="77-대표적인-cnn"><span class="mr-2">7.7 대표적인 CNN</span><a href="#77-대표적인-cnn" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="771-lenet"><span class="mr-2">7.7.1 LeNet</span><a href="#771-lenet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="https://t1.daumcdn.net/cfile/tistory/99145F445C4D51F114" data-proofer-ignore></p><ul><li>CNN의 원조<li>손글씨 숫자 인식 네트워크<li>합성곱과 서브 샘플링 계층 반복<ul><li>현재는 서브 샘플링 대신 최대 풀링<li>서브 샘플링은 2X2 필터로 average pooling</ul><li>마지막 층: 완전연결 계층<li>활성화 함수: sigmoid<ul><li>현재는 주로 ReLU 함수 사용</ul></ul><h3 id="772-alexnet"><span class="mr-2">7.7.2 AlexNet</span><a href="#772-alexnet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="https://t1.daumcdn.net/cfile/tistory/99B4DA3B5C4D52B515" data-proofer-ignore></p><ul><li>딥러닝 돌풍의 주역<li>LeNet과 큰 구조에서는 유사<li>변경점<ul><li>활성화 함수: ReLU<li>LRN(local response normalization): 국소적 정규화 계층<li>드롭아웃</ul></ul><p>딥러닝의 발전 원동력은?</p><ul><li>빅데이터<li>GPU</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ml/'>ML</a>, <a href='/categories/book-study/'>book_study</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/deep-learning/" class="post-tag no-text-decoration" >Deep_learning</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0+%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94+%EB%94%A5%EB%9F%AC%EB%8B%9D+Chapter07+-+Yh%27s+blog&url=https%3A%2F%2Fleeje008.github.io%2Fposts%2F%25EB%25B0%2591%25EB%25B0%2594%25EB%258B%25A5%25EB%25B6%2580%25ED%2584%25B0-%25EC%258B%259C%25EC%259E%2591%25ED%2595%2598%25EB%258A%2594-%25EB%2594%25A5%25EB%259F%25AC%25EB%258B%259D-Chapter07%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0+%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94+%EB%94%A5%EB%9F%AC%EB%8B%9D+Chapter07+-+Yh%27s+blog&u=https%3A%2F%2Fleeje008.github.io%2Fposts%2F%25EB%25B0%2591%25EB%25B0%2594%25EB%258B%25A5%25EB%25B6%2580%25ED%2584%25B0-%25EC%258B%259C%25EC%259E%2591%25ED%2595%2598%25EB%258A%2594-%25EB%2594%25A5%25EB%259F%25AC%25EB%258B%259D-Chapter07%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fleeje008.github.io%2Fposts%2F%25EB%25B0%2591%25EB%25B0%2594%25EB%258B%25A5%25EB%25B6%2580%25ED%2584%25B0-%25EC%258B%259C%25EC%259E%2591%25ED%2595%2598%25EB%258A%2594-%25EB%2594%25A5%25EB%259F%25AC%25EB%258B%259D-Chapter07%2F&text=%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0+%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94+%EB%94%A5%EB%9F%AC%EB%8B%9D+Chapter07+-+Yh%27s+blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="leeje008/leeje008.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0-%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94-%EB%94%A5%EB%9F%AC%EB%8B%9D-Chapter02/">밑바닥부터 시작하는 딥러닝 Chapter02</a><li><a href="/posts/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0-%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94-%EB%94%A5%EB%9F%AC%EB%8B%9D-Chapter03/">밑바닥부터 시작하는 딥러닝 Chapter03</a><li><a href="/posts/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0-%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94-%EB%94%A5%EB%9F%AC%EB%8B%9D-Chapter04/">밑바닥부터 시작하는 딥러닝 Chapter04</a><li><a href="/posts/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0-%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94-%EB%94%A5%EB%9F%AC%EB%8B%9D-Chapter06/">밑바닥부터 시작하는 딥러닝 Chapter06</a><li><a href="/posts/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0-%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94-%EB%94%A5%EB%9F%AC%EB%8B%9D-Chapter07/">밑바닥부터 시작하는 딥러닝 Chapter07</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/deep-learning/">Deep_learning</a> <a class="post-tag" href="/tags/subject-project/">subject_project</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0-%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94-%EB%94%A5%EB%9F%AC%EB%8B%9D-Chapter02/"><div class="card-body"> <em class="small" data-ts="1636815600" data-df="ll" > Nov 14, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>밑바닥부터 시작하는 딥러닝 Chapter02</h3><div class="text-muted small"><p> 퍼셉트론 퍼셉트론 perceptron 알고리즘. 프랑크 로젠블라트가 1957년 고안한 알고리즘이고, 신경망(딥러닝)의 기원이 되는 알고리즘이다. 퍼셉트론은 딥러닝으로 나아가는 데 중요한 아이디어를 준다. 퍼셉트론 다수의 신호를 입력으로 하나의 신호를 출력한다. 신호 : 전류나 강물처럼 흐름 1을 신호가 흐른다. 0을 신호가 흐...</p></div></div></a></div><div class="card"> <a href="/posts/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0-%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94-%EB%94%A5%EB%9F%AC%EB%8B%9D-Chapter03/"><div class="card-body"> <em class="small" data-ts="1636815600" data-df="ll" > Nov 14, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>밑바닥부터 시작하는 딥러닝 Chapter03</h3><div class="text-muted small"><p> 신경망 가중치 매개변수의 적절한 값을 데이터에서 자동으로 학습하는 능력이 신경망의 중요한 성질이다. 신경망의 개요, 신경망이 입력 데이터가 무엇인지 식별하는 처리 과정을 알아보자. 퍼셉트론에서 신경망으로 퍼셉트론과 다른 점으로 신경망 구조를 살펴보자. 신경망의 예 신경망 그림을 참고한다. 가장 왼쪽 줄을 입력층, 가장 오른쪽 줄을 출력층, ...</p></div></div></a></div><div class="card"> <a href="/posts/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0-%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94-%EB%94%A5%EB%9F%AC%EB%8B%9D-Chapter04/"><div class="card-body"> <em class="small" data-ts="1637334000" data-df="ll" > Nov 20, 2021 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>밑바닥부터 시작하는 딥러닝 Chapter04</h3><div class="text-muted small"><p> CH04 신경망 학습 학습이란? 훈련 데이터로부터 가중치 매개변수의 최적값을 자동으로 획득하는 것을 의미함 4.1 데이터로부터 학습한다 =&amp;gt; 신경망의 주요한 특징 中 하나는 데이터를 통해 가중치가 결정된다! 퍼셉트론 수렴 정리 내용: 선형 분리 문제는 유한번의 학습을 통해 풀 수 있다! 정리 $ X^+,X^- 가\ 선형\ 분리\ 가능...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/sample_post/" class="btn btn-outline-primary" prompt="Older"><p>Sample_post</p></a> <a href="/posts/%EB%B0%91%EB%B0%94%EB%8B%A5%EB%B6%80%ED%84%B0-%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94-%EB%94%A5%EB%9F%AC%EB%8B%9D-Chapter08/" class="btn btn-outline-primary" prompt="Newer"><p>밑바닥부터 시작하는 딥러닝 Chapter08</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/leeje008">Koyounghun</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">All rights reserved</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/deep-learning/">Deep_learning</a> <a class="post-tag" href="/tags/subject-project/">subject_project</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
